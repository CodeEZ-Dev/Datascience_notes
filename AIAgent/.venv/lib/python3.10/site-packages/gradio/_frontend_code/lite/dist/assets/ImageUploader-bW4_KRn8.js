import{a as ce,i as fe,s as _e,Q as se,q as d,l as W,v as y,w as Q,o as D,p as S,c as R,x as L,k as le,$ as ae,m as T,F as te,t as b,b as p,d as U,A as ye,f as z,r as K,aq as Ee,y as O,z as G,a4 as Je,I as Y,E as me,J as Ke,K as Qe,ax as Xe,N as Ye,P as Ze,aw as $e,ap as We,ar as xe,M as Ie,n as de,a6 as oe,a7 as ue,G as et,H as ge,W as ze,ay as tt,e as lt,u as it,h as nt,j as rt}from"../lite.js";import{B as st}from"./BlockLabel-B0HN-MOU.js";import{I as at,M as ot,a as ut}from"./Minimize-SPtAc8b5.js";import{W as ct,a as ft,S as _t}from"./SelectSource-CfNi7fcQ.js";import{I as mt}from"./IconButtonWrapper-Ck50MZwX.js";import{g as dt}from"./utils-Gtzs_Zla.js";import{D as Le}from"./DropdownArrow-B85Vabzi.js";import{S as gt}from"./Square-7hK0fZD1.js";import{f as ht}from"./index-BW-aT-V7.js";import{S as bt}from"./StreamingBar-C8nPcBp-.js";import{U as pt}from"./Upload-BskNBEHw.js";import{I as wt}from"./Image-CU9FxpGN.js";function vt(i){let e,t,l;return{c(){e=se("svg"),t=se("path"),l=se("circle"),d(t,"d","M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"),d(l,"cx","12"),d(l,"cy","13"),d(l,"r","4"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"width","100%"),d(e,"height","100%"),d(e,"viewBox","0 0 24 24"),d(e,"fill","none"),d(e,"stroke","currentColor"),d(e,"stroke-width","1.5"),d(e,"stroke-linecap","round"),d(e,"stroke-linejoin","round"),d(e,"class","feather feather-camera")},m(n,s){W(n,e,s),y(e,t),y(e,l)},p:Q,i:Q,o:Q,d(n){n&&D(e)}}}class kt extends ce{constructor(e){super(),fe(this,e,null,vt,_e,{})}}function It(i){let e,t;return{c(){e=se("svg"),t=se("circle"),d(t,"cx","12"),d(t,"cy","12"),d(t,"r","10"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"width","100%"),d(e,"height","100%"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width","1.5"),d(e,"stroke-linecap","round"),d(e,"stroke-linejoin","round"),d(e,"class","feather feather-circle")},m(l,n){W(l,e,n),y(e,t)},p:Q,i:Q,o:Q,d(l){l&&D(e)}}}class yt extends ce{constructor(e){super(),fe(this,e,null,It,_e,{})}}function zt(i){let e,t,l,n,s,r="Click to Access Webcam",o,a,c,_;return n=new ct({}),{c(){e=S("button"),t=S("div"),l=S("span"),R(n.$$.fragment),s=L(),o=le(r),d(l,"class","icon-wrap svelte-qbrfs"),d(t,"class","wrap svelte-qbrfs"),d(e,"class","svelte-qbrfs"),ae(e,"height","100%")},m(f,I){W(f,e,I),y(e,t),y(t,l),T(n,l,null),y(t,s),y(t,o),a=!0,c||(_=te(e,"click",i[1]),c=!0)},p:Q,i(f){a||(b(n.$$.fragment,f),a=!0)},o(f){p(n.$$.fragment,f),a=!1},d(f){f&&D(e),U(n),c=!1,_()}}}function Mt(i){const e=ye();return[e,()=>e("click")]}class Et extends ce{constructor(e){super(),fe(this,e,Mt,zt,_e,{})}}function Wt(){return navigator.mediaDevices.enumerateDevices()}function Dt(i,e){e.srcObject=i,e.muted=!0,e.play()}async function De(i,e,t){const l={width:{ideal:1920},height:{ideal:1440}},n={video:t?{deviceId:{exact:t},...l}:l,audio:i};return navigator.mediaDevices.getUserMedia(n).then(s=>(Dt(s,e),s))}function St(i){return i.filter(t=>t.kind==="videoinput")}function Se(i,e,t){const l=i.slice();return l[37]=e[t],l}function qt(i){let e,t,l,n,s,r,o,a,c,_,f;const I=[jt,Nt],E=[];function A(v,M){return v[2]==="video"||v[1]?0:1}l=A(i),n=E[l]=I[l](i);let g=!i[11]&&qe(i),w=i[13]&&i[8]&&Be(i);return{c(){e=S("div"),t=S("button"),n.c(),r=L(),g&&g.c(),o=L(),w&&w.c(),a=me(),d(t,"aria-label",s=i[2]==="image"?"capture photo":"start recording"),d(t,"class","svelte-s8feoe"),d(e,"class","button-wrap svelte-s8feoe")},m(v,M){W(v,e,M),y(e,t),E[l].m(t,null),y(e,r),g&&g.m(e,null),W(v,o,M),w&&w.m(v,M),W(v,a,M),c=!0,_||(f=te(t,"click",i[16]),_=!0)},p(v,M){let V=l;l=A(v),l===V?E[l].p(v,M):(O(),p(E[V],1,1,()=>{E[V]=null}),G(),n=E[l],n?n.p(v,M):(n=E[l]=I[l](v),n.c()),b(n,1),n.m(t,null)),(!c||M[0]&4&&s!==(s=v[2]==="image"?"capture photo":"start recording"))&&d(t,"aria-label",s),v[11]?g&&(O(),p(g,1,1,()=>{g=null}),G()):g?(g.p(v,M),M[0]&2048&&b(g,1)):(g=qe(v),g.c(),b(g,1),g.m(e,null)),v[13]&&v[8]?w?(w.p(v,M),M[0]&8448&&b(w,1)):(w=Be(v),w.c(),b(w,1),w.m(a.parentNode,a)):w&&(O(),p(w,1,1,()=>{w=null}),G())},i(v){c||(b(n),b(g),b(w),c=!0)},o(v){p(n),p(g),p(w),c=!1},d(v){v&&(D(e),D(o),D(a)),E[l].d(),g&&g.d(),w&&w.d(v),_=!1,f()}}}function Bt(i){let e,t,l,n;return t=new Et({}),t.$on("click",i[26]),{c(){e=S("div"),R(t.$$.fragment),d(e,"title","grant webcam access"),ae(e,"height","100%")},m(s,r){W(s,e,r),T(t,e,null),n=!0},p:Q,i(s){n||(b(t.$$.fragment,s),s&&(l||Ke(()=>{l=Qe(e,ht,{delay:100,duration:200}),l.start()})),n=!0)},o(s){p(t.$$.fragment,s),n=!1},d(s){s&&D(e),U(t)}}}function Nt(i){let e,t,l;return t=new kt({}),{c(){e=S("div"),R(t.$$.fragment),d(e,"class","icon svelte-s8feoe"),d(e,"title","capture photo")},m(n,s){W(n,e,s),T(t,e,null),l=!0},p:Q,i(n){l||(b(t.$$.fragment,n),l=!0)},o(n){p(t.$$.fragment,n),l=!1},d(n){n&&D(e),U(t)}}}function jt(i){let e,t,l,n;const s=[Ut,Tt,Rt],r=[];function o(a,c){return a[1]&&a[10]==="waiting"?0:a[1]&&a[10]==="open"||!a[1]&&a[11]?1:2}return e=o(i),t=r[e]=s[e](i),{c(){t.c(),l=me()},m(a,c){r[e].m(a,c),W(a,l,c),n=!0},p(a,c){let _=e;e=o(a),e===_?r[e].p(a,c):(O(),p(r[_],1,1,()=>{r[_]=null}),G(),t=r[e],t?t.p(a,c):(t=r[e]=s[e](a),t.c()),b(t,1),t.m(l.parentNode,l))},i(a){n||(b(t),n=!0)},o(a){p(t),n=!1},d(a){a&&D(l),r[e].d(a)}}}function Rt(i){let e,t,l,n,s=i[4]("audio.record")+"",r,o;return l=new yt({}),{c(){e=S("div"),t=S("div"),R(l.$$.fragment),n=L(),r=le(s),d(t,"class","icon color-primary svelte-s8feoe"),d(t,"title","start recording"),d(e,"class","icon-with-text svelte-s8feoe")},m(a,c){W(a,e,c),y(e,t),T(l,t,null),y(e,n),y(e,r),o=!0},p(a,c){(!o||c[0]&16)&&s!==(s=a[4]("audio.record")+"")&&de(r,s)},i(a){o||(b(l.$$.fragment,a),o=!0)},o(a){p(l.$$.fragment,a),o=!1},d(a){a&&D(e),U(l)}}}function Tt(i){let e,t,l,n,s=i[4]("audio.stop")+"",r,o;return l=new gt({}),{c(){e=S("div"),t=S("div"),R(l.$$.fragment),n=L(),r=le(s),d(t,"class","icon color-primary svelte-s8feoe"),d(t,"title","stop recording"),d(e,"class","icon-with-text svelte-s8feoe")},m(a,c){W(a,e,c),y(e,t),T(l,t,null),y(e,n),y(e,r),o=!0},p(a,c){(!o||c[0]&16)&&s!==(s=a[4]("audio.stop")+"")&&de(r,s)},i(a){o||(b(l.$$.fragment,a),o=!0)},o(a){p(l.$$.fragment,a),o=!1},d(a){a&&D(e),U(l)}}}function Ut(i){let e,t,l,n,s=i[4]("audio.waiting")+"",r,o;return l=new ft({}),{c(){e=S("div"),t=S("div"),R(l.$$.fragment),n=L(),r=le(s),d(t,"class","icon color-primary svelte-s8feoe"),d(t,"title","spinner"),d(e,"class","icon-with-text svelte-s8feoe"),ae(e,"width","var(--size-24)")},m(a,c){W(a,e,c),y(e,t),T(l,t,null),y(e,n),y(e,r),o=!0},p(a,c){(!o||c[0]&16)&&s!==(s=a[4]("audio.waiting")+"")&&de(r,s)},i(a){o||(b(l.$$.fragment,a),o=!0)},o(a){p(l.$$.fragment,a),o=!1},d(a){a&&D(e),U(l)}}}function qe(i){let e,t,l,n,s;return t=new Le({}),{c(){e=S("button"),R(t.$$.fragment),d(e,"class","icon svelte-s8feoe"),d(e,"aria-label","select input source")},m(r,o){W(r,e,o),T(t,e,null),l=!0,n||(s=te(e,"click",i[27]),n=!0)},p:Q,i(r){l||(b(t.$$.fragment,r),l=!0)},o(r){p(t.$$.fragment,r),l=!1},d(r){r&&D(e),U(t),n=!1,s()}}}function Be(i){let e,t,l,n,s,r,o;l=new Le({});function a(f,I){return f[7].length===0?Lt:Ct}let c=a(i),_=c(i);return{c(){e=S("select"),t=S("button"),R(l.$$.fragment),n=L(),_.c(),d(t,"class","inset-icon svelte-s8feoe"),d(e,"class","select-wrap svelte-s8feoe"),d(e,"aria-label","select source")},m(f,I){W(f,e,I),y(e,t),T(l,t,null),y(t,n),_.m(e,null),s=!0,r||(o=[te(t,"click",Xe(i[28])),Ye(Me.call(null,e,i[17])),te(e,"change",i[14])],r=!0)},p(f,I){c===(c=a(f))&&_?_.p(f,I):(_.d(1),_=c(f),_&&(_.c(),_.m(e,null)))},i(f){s||(b(l.$$.fragment,f),s=!0)},o(f){p(l.$$.fragment,f),s=!1},d(f){f&&D(e),U(l),_.d(),r=!1,Ze(o)}}}function Ct(i){let e,t=We(i[7]),l=[];for(let n=0;n<t.length;n+=1)l[n]=Ne(Se(i,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=me()},m(n,s){for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(n,s);W(n,e,s)},p(n,s){if(s[0]&384){t=We(n[7]);let r;for(r=0;r<t.length;r+=1){const o=Se(n,t,r);l[r]?l[r].p(o,s):(l[r]=Ne(o),l[r].c(),l[r].m(e.parentNode,e))}for(;r<l.length;r+=1)l[r].d(1);l.length=t.length}},d(n){n&&D(e),xe(l,n)}}}function Lt(i){let e,t=i[4]("common.no_devices")+"",l;return{c(){e=S("option"),l=le(t),e.__value="",Ie(e,e.__value),d(e,"class","svelte-s8feoe")},m(n,s){W(n,e,s),y(e,l)},p(n,s){s[0]&16&&t!==(t=n[4]("common.no_devices")+"")&&de(l,t)},d(n){n&&D(e)}}}function Ne(i){let e,t=i[37].label+"",l,n,s,r;return{c(){e=S("option"),l=le(t),n=L(),e.__value=s=i[37].deviceId,Ie(e,e.__value),e.selected=r=i[8].deviceId===i[37].deviceId,d(e,"class","svelte-s8feoe")},m(o,a){W(o,e,a),y(e,l),y(e,n)},p(o,a){a[0]&128&&t!==(t=o[37].label+"")&&de(l,t),a[0]&128&&s!==(s=o[37].deviceId)&&(e.__value=s,Ie(e,e.__value)),a[0]&384&&r!==(r=o[8].deviceId===o[37].deviceId)&&(e.selected=r)},d(o){o&&D(e)}}}function At(i){let e,t,l,n,s,r,o,a,c,_,f;t=new bt({props:{time_limit:i[9]}});const I=[Bt,qt],E=[];function A(g,w){return g[12]?1:0}return c=A(i),_=E[c]=I[c](i),{c(){e=S("div"),R(t.$$.fragment),l=L(),n=S("video"),s=L(),r=S("img"),a=L(),_.c(),d(n,"class","svelte-s8feoe"),K(n,"flip",i[3]),K(n,"hide",!i[12]||i[12]&&!!i[0]),Ee(r.src,o=i[0]?.url)||d(r,"src",o),d(r,"class","svelte-s8feoe"),K(r,"hide",!i[12]||i[12]&&!i[0]),d(e,"class","wrap svelte-s8feoe")},m(g,w){W(g,e,w),T(t,e,null),y(e,l),y(e,n),i[25](n),y(e,s),y(e,r),y(e,a),E[c].m(e,null),f=!0},p(g,w){const v={};w[0]&512&&(v.time_limit=g[9]),t.$set(v),(!f||w[0]&8)&&K(n,"flip",g[3]),(!f||w[0]&4097)&&K(n,"hide",!g[12]||g[12]&&!!g[0]),(!f||w[0]&1&&!Ee(r.src,o=g[0]?.url))&&d(r,"src",o),(!f||w[0]&4097)&&K(r,"hide",!g[12]||g[12]&&!g[0]);let M=c;c=A(g),c===M?E[c].p(g,w):(O(),p(E[M],1,1,()=>{E[M]=null}),G(),_=E[c],_?_.p(g,w):(_=E[c]=I[c](g),_.c()),b(_,1),_.m(e,null))},i(g){f||(b(t.$$.fragment,g),b(_),f=!0)},o(g){p(t.$$.fragment,g),p(_),f=!1},d(g){g&&D(e),U(t),i[25](null),E[c].d()}}}function Me(i,e){const t=l=>{i&&!i.contains(l.target)&&!l.defaultPrevented&&e(l)};return document.addEventListener("click",t,!0),{destroy(){document.removeEventListener("click",t,!0)}}}function Ft(i,e,t){let l,n=[],s=null,r=null,o="closed";const a=h=>{h==="closed"?(t(9,r=null),t(10,o="closed"),t(0,j=null)):h==="waiting"?t(10,o="waiting"):t(10,o="open")},c=h=>{B&&t(9,r=h)};let _,{streaming:f=!1}=e,{pending:I=!1}=e,{root:E=""}=e,{stream_every:A=1}=e,{mode:g="image"}=e,{mirror_webcam:w}=e,{include_audio:v}=e,{i18n:M}=e,{upload:V}=e,{value:j=null}=e;const F=ye();Je(()=>{_=document.createElement("canvas"),f&&g==="image"&&window.setInterval(()=>{l&&!I&&k()},A*1e3)});const q=async h=>{const J=h.target.value;await De(v,l,J).then(async ne=>{N=ne,t(8,s=n.find(re=>re.deviceId===J)||null),t(13,$=!1)})};async function m(){try{De(v,l).then(async h=>{t(12,ie=!0),t(7,n=await Wt()),N=h}).then(()=>St(n)).then(h=>{t(7,n=h);const C=N.getTracks().map(J=>J.getSettings()?.deviceId)[0];t(8,s=C&&h.find(J=>J.deviceId===C)||n[0])}),(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)&&F("error",M("image.no_webcam_support"))}catch(h){if(h instanceof DOMException&&h.name=="NotAllowedError")F("error",M("image.allow_webcam_access"));else throw h}}function k(){var h=_.getContext("2d");if((!f||f&&B)&&l.videoWidth&&l.videoHeight){if(_.width=l.videoWidth,_.height=l.videoHeight,h.drawImage(l,0,0,l.videoWidth,l.videoHeight),w&&(h.scale(-1,1),h.drawImage(l,-l.videoWidth,0)),f&&(!B||o==="waiting"))return;if(f){const C=_.toDataURL("image/jpeg");F("stream",C);return}_.toBlob(C=>{F(f?"stream":"capture",C)},`image/${f?"jpeg":"png"}`,.8)}}let B=!1,X=[],N,H,P;function Z(){if(B){P.stop();let h=new Blob(X,{type:H}),C=new FileReader;C.onload=async function(J){if(J.target){let ne=new File([h],"sample."+H.substring(6));const re=await $e([ne]);let ke=(await V(re,E))?.filter(Boolean)[0];F("capture",ke),F("stop_recording")}},C.readAsDataURL(h)}else{F("start_recording"),X=[];let h=["video/webm","video/mp4"];for(let C of h)if(MediaRecorder.isTypeSupported(C)){H=C;break}if(H===null){console.error("No supported MediaRecorder mimeType");return}P=new MediaRecorder(N,{mimeType:H}),P.addEventListener("dataavailable",function(C){X.push(C.data)}),P.start(200)}t(11,B=!B)}let ie=!1;function he(){g==="image"&&f&&t(11,B=!B),g==="image"?k():Z(),!B&&N&&(F("close_stream"),N.getTracks().forEach(h=>h.stop()),t(6,l.srcObject=null,l),t(12,ie=!1),window.setTimeout(()=>{t(0,j=null)},500),t(0,j=null))}let $=!1;function x(h){h.preventDefault(),h.stopPropagation(),t(13,$=!1)}function be(h){Y[h?"unshift":"push"](()=>{l=h,t(6,l)})}const pe=async()=>m(),we=()=>t(13,$=!0),ve=()=>t(13,$=!1);return i.$$set=h=>{"streaming"in h&&t(1,f=h.streaming),"pending"in h&&t(20,I=h.pending),"root"in h&&t(21,E=h.root),"stream_every"in h&&t(22,A=h.stream_every),"mode"in h&&t(2,g=h.mode),"mirror_webcam"in h&&t(3,w=h.mirror_webcam),"include_audio"in h&&t(23,v=h.include_audio),"i18n"in h&&t(4,M=h.i18n),"upload"in h&&t(24,V=h.upload),"value"in h&&t(0,j=h.value)},[j,f,g,w,M,Me,l,n,s,r,o,B,ie,$,q,m,he,x,a,c,I,E,A,v,V,be,pe,we,ve]}class Ht extends ce{constructor(e){super(),fe(this,e,Ft,At,_e,{modify_stream:18,set_time_limit:19,streaming:1,pending:20,root:21,stream_every:22,mode:2,mirror_webcam:3,include_audio:23,i18n:4,upload:24,value:0,click_outside:5},null,[-1,-1])}get modify_stream(){return this.$$.ctx[18]}get set_time_limit(){return this.$$.ctx[19]}get streaming(){return this.$$.ctx[1]}set streaming(e){this.$$set({streaming:e}),z()}get pending(){return this.$$.ctx[20]}set pending(e){this.$$set({pending:e}),z()}get root(){return this.$$.ctx[21]}set root(e){this.$$set({root:e}),z()}get stream_every(){return this.$$.ctx[22]}set stream_every(e){this.$$set({stream_every:e}),z()}get mode(){return this.$$.ctx[2]}set mode(e){this.$$set({mode:e}),z()}get mirror_webcam(){return this.$$.ctx[3]}set mirror_webcam(e){this.$$set({mirror_webcam:e}),z()}get include_audio(){return this.$$.ctx[23]}set include_audio(e){this.$$set({include_audio:e}),z()}get i18n(){return this.$$.ctx[4]}set i18n(e){this.$$set({i18n:e}),z()}get upload(){return this.$$.ctx[24]}set upload(e){this.$$set({upload:e}),z()}get value(){return this.$$.ctx[0]}set value(e){this.$$set({value:e}),z()}get click_outside(){return Me}}const Pt=Ht;function je(i){let e,t,l,n,s=!i[21]&&i[18]&&Re(i),r=i[21]&&i[18]&&Te(i);return l=new ze({props:{Icon:tt,label:"Remove Image"}}),l.$on("click",i[32]),{c(){s&&s.c(),e=L(),r&&r.c(),t=L(),R(l.$$.fragment)},m(o,a){s&&s.m(o,a),W(o,e,a),r&&r.m(o,a),W(o,t,a),T(l,o,a),n=!0},p(o,a){!o[21]&&o[18]?s?(s.p(o,a),a[0]&2359296&&b(s,1)):(s=Re(o),s.c(),b(s,1),s.m(e.parentNode,e)):s&&(O(),p(s,1,1,()=>{s=null}),G()),o[21]&&o[18]?r?(r.p(o,a),a[0]&2359296&&b(r,1)):(r=Te(o),r.c(),b(r,1),r.m(t.parentNode,t)):r&&(O(),p(r,1,1,()=>{r=null}),G())},i(o){n||(b(s),b(r),b(l.$$.fragment,o),n=!0)},o(o){p(s),p(r),p(l.$$.fragment,o),n=!1},d(o){o&&(D(e),D(t)),s&&s.d(o),r&&r.d(o),U(l,o)}}}function Re(i){let e,t;return e=new ze({props:{Icon:ot,label:i[21]?"Exit full screen":"View in full screen"}}),e.$on("click",i[29]),{c(){R(e.$$.fragment)},m(l,n){T(e,l,n),t=!0},p(l,n){const s={};n[0]&2097152&&(s.label=l[21]?"Exit full screen":"View in full screen"),e.$set(s)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){p(e.$$.fragment,l),t=!1},d(l){U(e,l)}}}function Te(i){let e,t;return e=new ze({props:{Icon:ut,label:i[21]?"Exit full screen":"View in full screen"}}),e.$on("click",i[29]),{c(){R(e.$$.fragment)},m(l,n){T(e,l,n),t=!0},p(l,n){const s={};n[0]&2097152&&(s.label=l[21]?"Exit full screen":"View in full screen"),e.$set(s)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){p(e.$$.fragment,l),t=!1},d(l){U(e,l)}}}function Vt(i){let e,t,l=i[3]?.url&&!i[19]&&je(i);return{c(){l&&l.c(),e=me()},m(n,s){l&&l.m(n,s),W(n,e,s),t=!0},p(n,s){n[3]?.url&&!n[19]?l?(l.p(n,s),s[0]&524296&&b(l,1)):(l=je(n),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(O(),p(l,1,1,()=>{l=null}),G())},i(n){t||(b(l),t=!0)},o(n){p(l),t=!1},d(n){n&&D(e),l&&l.d(n)}}}function Ue(i){let e;const t=i[31].default,l=lt(t,i,i[47],null);return{c(){l&&l.c()},m(n,s){l&&l.m(n,s),e=!0},p(n,s){l&&l.p&&(!e||s[1]&65536)&&it(l,t,n,n[47],e?rt(t,n[47],s,null):nt(n[47]),null)},i(n){e||(b(l,n),e=!0)},o(n){p(l,n),e=!1},d(n){l&&l.d(n)}}}function Ot(i){let e,t,l=i[3]===null&&Ue(i);return{c(){l&&l.c(),e=me()},m(n,s){l&&l.m(n,s),W(n,e,s),t=!0},p(n,s){n[3]===null?l?(l.p(n,s),s[0]&8&&b(l,1)):(l=Ue(n),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(O(),p(l,1,1,()=>{l=null}),G())},i(n){t||(b(l),t=!0)},o(n){p(l),t=!1},d(n){n&&D(e),l&&l.d(n)}}}function Gt(i){let e,t,l,n,s;return t=new wt({props:{src:i[3].url,alt:i[3].alt_text}}),{c(){e=S("div"),R(t.$$.fragment),d(e,"class","image-frame svelte-1ti4ehe"),K(e,"selectable",i[11])},m(r,o){W(r,e,o),T(t,e,null),l=!0,n||(s=te(e,"click",i[27]),n=!0)},p(r,o){const a={};o[0]&8&&(a.src=r[3].url),o[0]&8&&(a.alt=r[3].alt_text),t.$set(a),(!l||o[0]&2048)&&K(e,"selectable",r[11])},i(r){l||(b(t.$$.fragment,r),l=!0)},o(r){p(t.$$.fragment,r),l=!1},d(r){r&&D(e),U(t),n=!1,s()}}}function Jt(i){let e,t,l,n;function s(a){i[37](a)}function r(a){i[38](a)}let o={root:i[12],value:i[3],mirror_webcam:i[10],stream_every:i[17],streaming:i[9],mode:"image",include_audio:!1,i18n:i[13],upload:i[15]};return i[4]!==void 0&&(o.modify_stream=i[4]),i[5]!==void 0&&(o.set_time_limit=i[5]),e=new Pt({props:o}),Y.push(()=>oe(e,"modify_stream",s)),Y.push(()=>oe(e,"set_time_limit",r)),e.$on("capture",i[39]),e.$on("stream",i[40]),e.$on("error",i[41]),e.$on("drag",i[42]),e.$on("upload",i[43]),e.$on("close_stream",i[44]),{c(){R(e.$$.fragment)},m(a,c){T(e,a,c),n=!0},p(a,c){const _={};c[0]&4096&&(_.root=a[12]),c[0]&8&&(_.value=a[3]),c[0]&1024&&(_.mirror_webcam=a[10]),c[0]&131072&&(_.stream_every=a[17]),c[0]&512&&(_.streaming=a[9]),c[0]&8192&&(_.i18n=a[13]),c[0]&32768&&(_.upload=a[15]),!t&&c[0]&16&&(t=!0,_.modify_stream=a[4],ue(()=>t=!1)),!l&&c[0]&32&&(l=!0,_.set_time_limit=a[5],ue(()=>l=!1)),e.$set(_)},i(a){n||(b(e.$$.fragment,a),n=!0)},o(a){p(e.$$.fragment,a),n=!1},d(a){U(e,a)}}}function Ce(i){let e,t,l;function n(r){i[45](r)}let s={sources:i[8],handle_clear:i[24],handle_select:i[28]};return i[1]!==void 0&&(s.active_source=i[1]),e=new _t({props:s}),Y.push(()=>oe(e,"active_source",n)),{c(){R(e.$$.fragment)},m(r,o){T(e,r,o),l=!0},p(r,o){const a={};o[0]&256&&(a.sources=r[8]),!t&&o[0]&2&&(t=!0,a.active_source=r[1],ue(()=>t=!1)),e.$set(a)},i(r){l||(b(e.$$.fragment,r),l=!0)},o(r){p(e.$$.fragment,r),l=!1},d(r){U(e,r)}}}function Kt(i){let e,t,l,n,s,r,o,a,c,_,f,I,E,A=i[8].length>1||i[8].includes("clipboard"),g;e=new st({props:{show_label:i[7],Icon:at,label:i[6]||"Image"}}),n=new mt({props:{$$slots:{default:[Vt]},$$scope:{ctx:i}}});function w(m){i[34](m)}function v(m){i[35](m)}let M={hidden:i[3]!==null||i[1]==="webcam",filetype:i[1]==="clipboard"?"clipboard":"image/*",root:i[12],max_file_size:i[14],disable_click:!i[8].includes("upload")||i[3]!==null,upload:i[15],stream_handler:i[16],$$slots:{default:[Ot]},$$scope:{ctx:i}};i[0]!==void 0&&(M.uploading=i[0]),i[2]!==void 0&&(M.dragging=i[2]),o=new pt({props:M}),i[33](o),Y.push(()=>oe(o,"uploading",w)),Y.push(()=>oe(o,"dragging",v)),o.$on("load",i[23]),o.$on("error",i[36]);const V=[Jt,Gt],j=[];function F(m,k){return m[1]==="webcam"&&(m[9]||!m[9]&&!m[3])?0:m[3]!==null&&!m[9]?1:-1}~(f=F(i))&&(I=j[f]=V[f](i));let q=A&&Ce(i);return{c(){R(e.$$.fragment),t=L(),l=S("div"),R(n.$$.fragment),s=L(),r=S("div"),R(o.$$.fragment),_=L(),I&&I.c(),E=L(),q&&q.c(),d(r,"class","upload-container svelte-1ti4ehe"),K(r,"reduced-height",i[8].length>1),ae(r,"width",i[3]?"auto":"100%"),d(l,"data-testid","image"),d(l,"class","image-container svelte-1ti4ehe")},m(m,k){T(e,m,k),W(m,t,k),W(m,l,k),T(n,l,null),y(l,s),y(l,r),T(o,r,null),y(r,_),~f&&j[f].m(r,null),y(l,E),q&&q.m(l,null),i[46](l),g=!0},p(m,k){const B={};k[0]&128&&(B.show_label=m[7]),k[0]&64&&(B.label=m[6]||"Image"),e.$set(B);const X={};k[0]&2883592|k[1]&65536&&(X.$$scope={dirty:k,ctx:m}),n.$set(X);const N={};k[0]&10&&(N.hidden=m[3]!==null||m[1]==="webcam"),k[0]&2&&(N.filetype=m[1]==="clipboard"?"clipboard":"image/*"),k[0]&4096&&(N.root=m[12]),k[0]&16384&&(N.max_file_size=m[14]),k[0]&264&&(N.disable_click=!m[8].includes("upload")||m[3]!==null),k[0]&32768&&(N.upload=m[15]),k[0]&65536&&(N.stream_handler=m[16]),k[0]&8|k[1]&65536&&(N.$$scope={dirty:k,ctx:m}),!a&&k[0]&1&&(a=!0,N.uploading=m[0],ue(()=>a=!1)),!c&&k[0]&4&&(c=!0,N.dragging=m[2],ue(()=>c=!1)),o.$set(N);let H=f;f=F(m),f===H?~f&&j[f].p(m,k):(I&&(O(),p(j[H],1,1,()=>{j[H]=null}),G()),~f?(I=j[f],I?I.p(m,k):(I=j[f]=V[f](m),I.c()),b(I,1),I.m(r,null)):I=null),(!g||k[0]&256)&&K(r,"reduced-height",m[8].length>1),k[0]&8&&ae(r,"width",m[3]?"auto":"100%"),k[0]&256&&(A=m[8].length>1||m[8].includes("clipboard")),A?q?(q.p(m,k),k[0]&256&&b(q,1)):(q=Ce(m),q.c(),b(q,1),q.m(l,null)):q&&(O(),p(q,1,1,()=>{q=null}),G())},i(m){g||(b(e.$$.fragment,m),b(n.$$.fragment,m),b(o.$$.fragment,m),b(I),b(q),g=!0)},o(m){p(e.$$.fragment,m),p(n.$$.fragment,m),p(o.$$.fragment,m),p(I),p(q),g=!1},d(m){m&&(D(t),D(l)),U(e,m),U(n),i[33](null),U(o),~f&&j[f].d(),q&&q.d(),i[46](null)}}}function Qt(i,e,t){let l,{$$slots:n={},$$scope:s}=e,{value:r=null}=e,{label:o=void 0}=e,{show_label:a}=e,{sources:c=["upload","clipboard","webcam"]}=e,{streaming:_=!1}=e,{pending:f=!1}=e,{mirror_webcam:I}=e,{selectable:E=!1}=e,{root:A}=e,{i18n:g}=e,{max_file_size:w=null}=e,{upload:v}=e,{stream_handler:M}=e,{stream_every:V}=e,{modify_stream:j}=e,{set_time_limit:F}=e,{show_fullscreen_button:q=!0}=e,m,{uploading:k=!1}=e,{active_source:B=null}=e;function X({detail:u}){_||(t(3,r=u),P("upload"))}function N(){t(3,r=null),P("clear"),P("change",null)}async function H(u,ee){if(ee==="stream"){P("stream",{value:{url:u},is_value_data:!0});return}t(30,f=!0);const Ge=await m.load_files([new File([u],`image/${_?"jpeg":"png"}`)]);(ee==="change"||ee==="upload")&&(t(3,r=Ge?.[0]||null),await et(),P("change")),t(30,f=!1)}const P=ye();let{dragging:Z=!1}=e;function ie(u){let ee=dt(u);ee&&P("select",{index:ee,value:null})}async function he(u){switch(u){case"clipboard":m.paste_clipboard();break}}let $=!1,x;const be=async()=>{await x.requestFullscreen()},pe=u=>{t(3,r=null),P("clear"),u.stopPropagation()};function we(u){Y[u?"unshift":"push"](()=>{m=u,t(20,m)})}function ve(u){k=u,t(0,k)}function h(u){Z=u,t(2,Z)}function C(u){ge.call(this,i,u)}function J(u){j=u,t(4,j)}function ne(u){F=u,t(5,F)}const re=u=>H(u.detail,"change"),ke=u=>H(u.detail,"stream");function Ae(u){ge.call(this,i,u)}function Fe(u){ge.call(this,i,u)}const He=u=>H(u.detail,"upload");function Pe(u){ge.call(this,i,u)}function Ve(u){B=u,t(1,B),t(8,c)}function Oe(u){Y[u?"unshift":"push"](()=>{x=u,t(22,x)})}return i.$$set=u=>{"value"in u&&t(3,r=u.value),"label"in u&&t(6,o=u.label),"show_label"in u&&t(7,a=u.show_label),"sources"in u&&t(8,c=u.sources),"streaming"in u&&t(9,_=u.streaming),"pending"in u&&t(30,f=u.pending),"mirror_webcam"in u&&t(10,I=u.mirror_webcam),"selectable"in u&&t(11,E=u.selectable),"root"in u&&t(12,A=u.root),"i18n"in u&&t(13,g=u.i18n),"max_file_size"in u&&t(14,w=u.max_file_size),"upload"in u&&t(15,v=u.upload),"stream_handler"in u&&t(16,M=u.stream_handler),"stream_every"in u&&t(17,V=u.stream_every),"modify_stream"in u&&t(4,j=u.modify_stream),"set_time_limit"in u&&t(5,F=u.set_time_limit),"show_fullscreen_button"in u&&t(18,q=u.show_fullscreen_button),"uploading"in u&&t(0,k=u.uploading),"active_source"in u&&t(1,B=u.active_source),"dragging"in u&&t(2,Z=u.dragging),"$$scope"in u&&t(47,s=u.$$scope)},i.$$.update=()=>{i.$$.dirty[0]&258&&!B&&c&&t(1,B=c[0]),i.$$.dirty[0]&514&&t(19,l=_&&B==="webcam"),i.$$.dirty[0]&524289&&k&&!l&&t(3,r=null),i.$$.dirty[0]&4&&P("drag",Z)},[k,B,Z,r,j,F,o,a,c,_,I,E,A,g,w,v,M,V,q,l,m,$,x,X,N,H,P,ie,he,be,f,n,pe,we,ve,h,C,J,ne,re,ke,Ae,Fe,He,Pe,Ve,Oe,s]}class Xt extends ce{constructor(e){super(),fe(this,e,Qt,Kt,_e,{value:3,label:6,show_label:7,sources:8,streaming:9,pending:30,mirror_webcam:10,selectable:11,root:12,i18n:13,max_file_size:14,upload:15,stream_handler:16,stream_every:17,modify_stream:4,set_time_limit:5,show_fullscreen_button:18,uploading:0,active_source:1,dragging:2},null,[-1,-1])}get value(){return this.$$.ctx[3]}set value(e){this.$$set({value:e}),z()}get label(){return this.$$.ctx[6]}set label(e){this.$$set({label:e}),z()}get show_label(){return this.$$.ctx[7]}set show_label(e){this.$$set({show_label:e}),z()}get sources(){return this.$$.ctx[8]}set sources(e){this.$$set({sources:e}),z()}get streaming(){return this.$$.ctx[9]}set streaming(e){this.$$set({streaming:e}),z()}get pending(){return this.$$.ctx[30]}set pending(e){this.$$set({pending:e}),z()}get mirror_webcam(){return this.$$.ctx[10]}set mirror_webcam(e){this.$$set({mirror_webcam:e}),z()}get selectable(){return this.$$.ctx[11]}set selectable(e){this.$$set({selectable:e}),z()}get root(){return this.$$.ctx[12]}set root(e){this.$$set({root:e}),z()}get i18n(){return this.$$.ctx[13]}set i18n(e){this.$$set({i18n:e}),z()}get max_file_size(){return this.$$.ctx[14]}set max_file_size(e){this.$$set({max_file_size:e}),z()}get upload(){return this.$$.ctx[15]}set upload(e){this.$$set({upload:e}),z()}get stream_handler(){return this.$$.ctx[16]}set stream_handler(e){this.$$set({stream_handler:e}),z()}get stream_every(){return this.$$.ctx[17]}set stream_every(e){this.$$set({stream_every:e}),z()}get modify_stream(){return this.$$.ctx[4]}set modify_stream(e){this.$$set({modify_stream:e}),z()}get set_time_limit(){return this.$$.ctx[5]}set set_time_limit(e){this.$$set({set_time_limit:e}),z()}get show_fullscreen_button(){return this.$$.ctx[18]}set show_fullscreen_button(e){this.$$set({show_fullscreen_button:e}),z()}get uploading(){return this.$$.ctx[0]}set uploading(e){this.$$set({uploading:e}),z()}get active_source(){return this.$$.ctx[1]}set active_source(e){this.$$set({active_source:e}),z()}get dragging(){return this.$$.ctx[2]}set dragging(e){this.$$set({dragging:e}),z()}}const ol=Xt;export{ol as I,Pt as W};
//# sourceMappingURL=ImageUploader-bW4_KRn8.js.map
